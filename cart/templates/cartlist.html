{% extends 'index.html' %}
{% load static %}
{% block title %}
  <title>Cart - Fantasy Foods</title>
{% endblock %}
{% block content%}
  <!-- Bootstrap -->
  

  <div class="max-w-7xl mx-auto pt-28 grid grid-cols-1 lg:grid-cols-3 gap-6">

    <!-- LEFT SECTION - CART ITEMS -->
    <div class="lg:col-span-2 space-y-5">

      <!-- Cart Header -->
      <div class="bg-white p-4 rounded shadow flex justify-between items-center">
        <h2 class="text-2xl font-semibold ">
          <i class="fa-solid fa-cart-shopping text-xl text-fantasy-gold"></i>
        Shopping Cart</h2>
        <p class="text-gray-500 text-sm">{{ item_count }} items</p>
      </div>

      <!-- ITEM CARD -->
 {% for cart in items %}
<div class="bg-white p-5 rounded-lg shadow flex flex-col md:flex-row gap-5">

  <!-- Product Image -->
   <a href="{% url 'user_product' cart.variant.product.slug %}">
  <img src="{{ cart.variant.product.main_image.url }}"
       class="w-32 h-32 object-cover rounded"></a>

  <!-- Product Details -->
  <div class="flex-1">

    <h3 class="text-lg font-semibold">
      {{ cart.variant.product.name }}
    </h3>

    <p class="text-sm text-gray-500">
      {{ cart.variant.product.category }}
    </p>

    <p class="text-sm text-gray-500 mt-1">
      Size:
      <span class="font-medium text-gray-700">
        {{ cart.variant.size_name }}
      </span>
    </p>

    <p class="text-xs text-gray-400">
      Best Before: {{ cart.variant.product.best_before }}
    </p>

    <!-- Pricing -->
    <div class="mt-2 flex items-center gap-3">
      <p class="text-xl font-bold text-gray-900">
        ‚Çπ{{ cart.total_price }}
      </p>
    </div>

    <!-- Qty & Actions -->
    <div class="flex flex-col md:flex-row gap-4 mt-3 items-start md:items-center">
      
       <p> Qty: {{ cart.quantity }}</p>
     

      <form method="POST" action="{% url 'cart:remove_cart' cart.variant.id %}">
          {% csrf_token %}
          <button class="text-red-600 text-sm font-medium hover:underline">
              Remove
          </button>
      </form>

      {% if item.variant %}
      <a href="{% url 'cart:move_to_wishlist' item.variant.id %}"
        class="text-sm text-pink-600 hover:underline">
        Move to Wishlist ‚ù§Ô∏è
      </a>
      {% endif %}
    </div>
  </div>
</div>
{% empty %}
  <div class="col-span-full flex flex-col items-center justify-center py-16 text-center">
  <!-- Background Image -->
  <img
      src="{% static 'images/boy.png' %}"
      alt="Empty Wishlist"
      class="w-60 opacity-20"
  />
      <h3 class="text-2xl font-bold text-gray-800 mb-2">
          Oops! Your Cart is Empty
      </h3>
      <p class="text-base text-gray-600">
          Browse our <a href="{% url 'products' %}"
           class="text-blue-600 hover:text-blue-800 transition-colors duration-300 font-semibold">
            products </a>and add your favorites to make your Cart magical ‚ú®
      </p>
</div>

{% endfor %}
</div>
    <!-- RIGHT SECTION - BILL SUMMARY -->
<div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-100 sticky top-24">

  <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
    <i class="fa-solid fa-receipt text-fantasy-brown"></i>
    Price Details
  </h3>

  <!-- Subtotal -->
  <div class="flex justify-between text-sm py-2 border-b border-dashed">
    <span class="text-gray-600">Subtotal ({{ total_items }} items)</span>
    <span class="font-semibold text-gray-800">‚Çπ{{ subtotal }}</span>
  </div>

  <!-- Delivery -->
  <div class="flex justify-between text-sm py-2 border-b border-dashed">
    <span class="text-gray-600">Delivery</span>
    {% if delivery_charge == 0 %}
      <span class="text-green-600 font-semibold">Free üöö</span>
    {% else %}
      <span class="font-semibold text-gray-800">‚Çπ{{ delivery_charge }}</span>
    {% endif %}
  </div>

  <!-- Discount -->
  <div class="flex justify-between text-sm py-2 border-b border-dashed">
    <span class="text-gray-600">Discount</span>
    <span class="text-green-600 font-semibold">-‚Çπ{{ discount }}</span>
  </div>

  <!-- Tax -->
  <div class="flex justify-between text-sm py-2 border-b border-dashed">
    <span class="text-gray-600">Tax & GST</span>
    <span class="font-semibold text-gray-800">‚Çπ{{ tax }}</span>
  </div>

  <!-- Total -->
  <div class="flex justify-between text-lg font-bold py-4 mt-2 border-t">
    <span>Total Amount</span>
    <span class="text-fantasy-brown">‚Çπ{{ total|floatformat:2 }}</span>
  </div>

  <!-- Coupon -->
  <div class="mt-4">
    <label class="text-sm font-medium text-gray-600">Have a coupon?</label>
    <div class="flex gap-2 mt-2">
      <input
        class="w-full px-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-fantasy-brown focus:outline-none"
        placeholder="Enter coupon code">
      <button class="px-4 py-2 rounded-lg bg-gray-800 text-white hover:bg-green-600 transition-all">
        Apply
      </button>
    </div>
  </div>

  <!-- Checkout Button -->
  <button class="w-full mt-6 py-3 rounded-xl bg-fantasy-brown text-white font-bold text-lg shadow-md hover:shadow-lg hover:scale-[1.02] transition transform">
    Proceed to Checkout
  </button>

  <!-- Continue Shopping -->
  <a href="{% url 'products' %}"
     class="block text-center mt-4 text-sm font-semibold text-fantasy-brown hover:underline">
    Continue Shopping
  </a>

</div>


  </div>

{% endblock %}
