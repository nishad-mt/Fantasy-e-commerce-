{% extends "index.html" %}
{% load static %}

{% block title %}Order Details | Fantasy Bakery{% endblock %}

{% block content %}
<section class="bg-fantasy-cream min-h-screen pt-32 pb-20">
    <div class="max-w-5xl mx-auto px-4 space-y-8">

        <!-- PAGE HEADER -->
        <div class="flex flex-wrap justify-between items-center gap-4">
            <div>
                <h1 class="text-3xl font-serif font-bold text-fantasy-brown">
                    Order Details
                </h1>
                <p class="text-sm text-gray-500 mt-1">
                    Order ID: <span class="font-semibold">FFN-99214</span>
                </p>
            </div>

            <span class="px-4 py-1 rounded-full text-sm font-semibold bg-green-100 text-green-700">
                Delivered
            </span>
        </div>

        <!-- ORDER TRACKING -->
        <div class="bg-white rounded-2xl shadow-sm border p-6">
            <h2 class="font-bold text-lg text-fantasy-brown mb-4">
                Order Tracking
            </h2>

            <div class="space-y-4">
                <div class="flex items-center gap-4">
                    <div class="w-4 h-4 rounded-full bg-green-500"></div>
                    <div>
                        <p class="font-semibold text-gray-800">Order Placed</p>
                        <p class="text-xs text-gray-500">28 Nov 2025</p>
                    </div>
                </div>

                <div class="flex items-center gap-4">
                    <div class="w-4 h-4 rounded-full bg-green-500"></div>
                    <div>
                        <p class="font-semibold text-gray-800">Order Confirmed</p>
                        <p class="text-xs text-gray-500">28 Nov 2025</p>
                    </div>
                </div>

                <div class="flex items-center gap-4">
                    <div class="w-4 h-4 rounded-full bg-green-500"></div>
                    <div>
                        <p class="font-semibold text-gray-800">Shipped</p>
                        <p class="text-xs text-gray-500">29 Nov 2025</p>
                    </div>
                </div>

                <div class="flex items-center gap-4">
                    <div class="w-4 h-4 rounded-full bg-green-500"></div>
                    <div>
                        <p class="font-semibold text-gray-800">Delivered</p>
                        <p class="text-xs text-gray-500">30 Nov 2025</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ORDER ITEMS -->
        <div class="bg-white rounded-2xl shadow-sm border">
            <div class="p-6 border-b">
                <h2 class="font-bold text-lg text-fantasy-brown">
                    Ordered Items
                </h2>
            </div>
            {% for item in items %}
            <div class="divide-y">
                <div class="flex gap-4 p-6">
                    <img src="{{ item.variant.product.main_image.url }}"
                         class="w-24 h-24 rounded-xl object-cover border">

                    <div class="flex-1">
                        <h3 class="font-semibold text-gray-800">
                            {{ item.variant.product.name }}
                        </h3>
                        <p class="text-sm text-gray-500 mt-1">
                            Variant: {{ item.variant.size_name }}
                        </p>
                        <p class="text-sm text-gray-500">
                            Quantity: {{ item.quantity}}
                        </p>
                        <p class="font-bold text-fantasy-brown mt-2">
                            ₹{{ item.price }}
                        </p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- DELIVERY & PAYMENT -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

            <!-- DELIVERY ADDRESS -->
            <div class="bg-white rounded-2xl shadow-sm border p-6">
                <h3 class="font-bold text-lg text-fantasy-brown mb-3">
                    Delivery Address
                </h3>

                <p class="font-semibold text-gray-800">
                    {{order.address.name}}
                </p>
                <p class="text-sm text-gray-600 mt-1 leading-relaxed">
                    {{ order.address.street }} <br>
                    {{ order.address.city }}, {{ order.address.state }} – {{ order.address.pincode }} <br>
                    Phone: +91 {{ order.address.phone }}
                </p>
            </div>

            <!-- PAYMENT SUMMARY -->
            <div class="bg-white rounded-2xl shadow-sm border p-6">
                <h3 class="font-bold text-lg text-fantasy-brown mb-3">
                    Payment Summary
                </h3>

                <div class="space-y-2 text-sm">
                    <div class="flex justify-between text-gray-600">
                        <span>Items Total</span>
                        <span>₹{{ order.order_items_total }}</span>
                    </div>

                    <div class="flex justify-between text-gray-600">
                        <span>Delivery Charges</span>
                            {% if order.delivery_charge == 0 %}
                                <span class="text-green-600 font-semibold">FREE</span>
                            {% else %}
                                <span>₹{{ order.delivery_charge|floatformat:2 }}</span>
                            {% endif %}                    
                    </div>

                    <div class="flex justify-between text-green-600">
                        <span>Discount</span>
                        <span>- ₹0</span>
                    </div>

                    <div class="flex justify-between border-t pt-3 font-bold text-lg">
                        <span>Total</span>
                        <span class="text-fantasy-brown">
                            ₹{{ order.total_amount }}
                        </span>
                    </div>

                    <p class="text-xs text-gray-500 mt-2">
                        Payment Method: {{ order.get_payment_method_display }}
                    </p>
                </div>
            </div>

        </div>

        <!-- ACTION BUTTONS -->
        <div class="flex flex-wrap gap-4">
            <button class="px-6 py-2 rounded-lg border border-orange-500 text-orange-600 font-semibold hover:bg-orange-50">
                Cancel Request
            </button>
        </div>

    </div>
</section>
{% endblock %}
